<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Logic</title>
		<script>
model = {
	"problem": {
		"Buyer": [
			"Glyn", "Harry", "Ian", "Jamie", "Kevin"
		],
		"CD": [
			"Caught Out", "Friends", "Our World", "Wild Looks", "Yellow Moon"
		],
		"Band": [
			"Girl Rock", "The Goods", "Headway", "Hi Pitch", "The Petals"
		]
	},
	"clauses": [
		[ "Buyer::Jamie", "Band::Headway", true ],
		[ "Buyer::Harry", "CD::Our World", true ],
		[ "CD::Caught Out", "Band::Hi Pitch", true ],
		[ "CD::Caught Out", "Buyer::Glyn", false ],
		[ "Band::Hi Pitch", "Buyer::Glyn", false ],
		[ "Buyer::Ian", "CD::Wild Looks", true ],
		[ "Buyer::Ian", "Band::The Petals", false ],
		[ "Band::Girl Rock", "CD::Yellow Moon", true ]
	]
};

draw = function() {
	var canvas = document.getElementById('logic');
	var ctx = canvas.getContext('2d');
	ctx.textAlign = 'left';
	
	var problem = model.problem;
	var groupNames = [];

	for (var groupName in problem) groupNames.push(groupName);

	ctx.moveTo(106,0);
	ctx.lineTo(106,105);
	ctx.lineTo(0,105);
	ctx.stroke();
	
	var y = 120;
	var gy = 0;
	while (true) {
		var groupName = groupNames[gy];
		var group = problem[groupName];
		var sz = group.length * 20 - 20;
		
		// side group name
		ctx.save();
		ctx.translate(10, y + sz/2);
		ctx.rotate(-Math.PI / 2);
		ctx.textAlign = 'center';
		ctx.fillText(groupName, 0, 0, sz);
		ctx.restore();
		
		// side items
		ctx.textAlign = 'right';
		for (var i in group) {
			var item = group[i];
			ctx.fillText(item, 100, y, 100);
			y += 20;
		}

		ctx.moveTo(y-13,0);
		ctx.lineTo(y-13,105);
		ctx.stroke();

		// side: 0, n ... 3, 2
		if (gy == 2) break;
		else if (gy == 0) gy = groupNames.length - 1;
		else gy--;
	}
	
	var x = 120;
	// top: 1, 2 ... n
	for (var gx = 1; gx < groupNames.length; gx++) {
		// top group name

		var groupName = groupNames[gx];
		var group = problem[groupName];
		var sz = group.length * 20 - 20;
		
		ctx.textAlign = 'center';
		ctx.fillText(groupName, x + sz/2, 10, sz);
		
		// top items
		for (var i in group) {
			var item = group[i];
			ctx.save();
			ctx.translate(x, 100);
			ctx.rotate(-Math.PI / 2);
			ctx.textAlign = 'left';
			ctx.fillText(item, 0, 0, 100);
			ctx.restore();
			x += 20;
		}
		
		ctx.moveTo(0,x-13);
		ctx.lineTo(105,x-13);
		ctx.stroke();
	}
}


		</script>
	</head>
	<body onload="draw()">
		<canvas id="logic" width="400" height="400"></canvas>
	</body>
</html>
